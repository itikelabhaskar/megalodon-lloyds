{
  "cache_metadata": {
    "last_updated": "2025-12-12T14:54:31.665194",
    "version": "1.0.0"
  },
  "tables": {
    "policies_week1": {
      "rules": [
        {
          "rule_id": "DQ_COMPLETENESS_001",
          "name": "cus_death_date_null_rate_check",
          "description": "Check if CUS_DEATH_DATE is NULL when CUS_LIFE_STATUS is 'DCD'",
          "natural_language": "If a customer is deceased, their death date should be populated.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE CUS_LIFE_STATUS = 'DCD' AND CUS_DEATH_DATE IS NULL",
          "severity": "critical",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "dataplex",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_COMPLETENESS_002",
          "name": "scm_sch_leave_date_null_rate_check",
          "description": "Check if SCM_SCH_LEAVE_DATE is populated",
          "natural_language": "SCM_SCH_LEAVE_DATE should be populated.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE SCM_SCH_LEAVE_DATE IS NULL",
          "severity": "medium",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "dataplex",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_ACCURACY_001",
          "name": "cus_dob_future_check",
          "description": "Check if customer date of birth is not in the future",
          "natural_language": "Customer date of birth cannot be a future date.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE SAFE.PARSE_DATE('%Y-%m-%d', CUS_DOB) > CURRENT_DATE()",
          "severity": "critical",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_ACCURACY_002",
          "name": "poli_gross_pmt_negative_check",
          "description": "Check if policy gross payment is not negative",
          "natural_language": "Policy gross payment cannot be a negative value.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE POLI_GROSS_PMT < 0",
          "severity": "high",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_CONFORMITY_001",
          "name": "cus_ni_no_format_check",
          "description": "Check if customer NI number follows the UK format",
          "natural_language": "Customer NI number must follow the UK format (2 letters + 6 digits + 1 letter).",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE CUS_NI_NO IS NOT NULL AND NOT REGEXP_CONTAINS(CUS_NI_NO, r'^[A-Z]{2}[0-9]{6}[A-D]$')",
          "severity": "medium",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_TEMPORAL_001",
          "name": "deceased_status_reversal_check",
          "description": "Check if a customer marked as deceased in an earlier week becomes alive in a later week",
          "natural_language": "Customers who were deceased should not become alive in later weeks - this indicates a data quality issue",
          "sql": "SELECT w2.CUS_ID, w1.CUS_LIFE_STATUS as week1_status, w2.CUS_LIFE_STATUS as week2_status FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_LIFE_STATUS = 'DCD' AND w2.CUS_LIFE_STATUS <> 'DCD'",
          "severity": "critical",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_TEMPORAL_002",
          "name": "death_date_consistency_check",
          "description": "Check if the death date changes between weeks for the same customer",
          "natural_language": "A customer's death date should not change between weeks unless there is a correction.",
          "sql": "SELECT w1.CUS_ID, w1.CUS_DEATH_DATE AS week1_death_date, w2.CUS_DEATH_DATE AS week2_death_date FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_DEATH_DATE IS NOT NULL AND w2.CUS_DEATH_DATE IS NOT NULL AND w1.CUS_DEATH_DATE != w2.CUS_DEATH_DATE",
          "severity": "high",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_TEMPORAL_003",
          "name": "premium_fluctuation_check",
          "description": "Check for significant fluctuations in policy gross premium between weeks",
          "natural_language": "Policy gross premium should not fluctuate significantly between weeks without a valid reason.",
          "sql": "SELECT w1.CUS_ID, w1.POLI_GROSS_PMT AS week1_premium, w2.POLI_GROSS_PMT AS week2_premium FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE ABS(w1.POLI_GROSS_PMT - w2.POLI_GROSS_PMT) > (0.2 * w1.POLI_GROSS_PMT)",
          "severity": "medium",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_COMPLETENESS_003",
          "name": "cus_postcode_null_check",
          "description": "Check if customer postcode is populated",
          "natural_language": "Customer postcode should be populated.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE CUS_POSTCODE IS NULL",
          "severity": "low",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "dataplex",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_ACCURACY_003",
          "name": "renewal_date_past_check",
          "description": "Check if policy renewal date is not in the past",
          "natural_language": "Policy renewal date cannot be a past date.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE SAFE.PARSE_DATE('%Y-%m-%d', SCH_RENEWAL_DT) < CURRENT_DATE()",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_CONFORMITY_002",
          "name": "cus_sex_cd_valid_check",
          "description": "Check if customer sex code is a valid value (e.g., M, F)",
          "natural_language": "Customer sex code must be a valid value (e.g., M, F).",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE CUS_SEX_CD NOT IN ('M', 'F')",
          "severity": "medium",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_TEMPORAL_004",
          "name": "dob_change_across_weeks",
          "description": "Check if customer DOB changes between weeks",
          "natural_language": "Customer DOB should not change between weeks.",
          "sql": "SELECT w1.CUS_ID, w1.CUS_DOB AS week1_dob, w2.CUS_DOB AS week2_dob FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_DOB != w2.CUS_DOB",
          "severity": "high",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_ACCURACY_004",
          "name": "income_payment_reasonableness_check",
          "description": "Check if income payment is within a reasonable range",
          "natural_language": "Income payment should be within a reasonable range.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE POLI_INCOME_PMT > 100000",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_CONFORMITY_003",
          "name": "policy_id_format_check",
          "description": "Check if policy ID follows a specific format",
          "natural_language": "Policy ID should follow a specific format.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE CRL_KEY_POLICY_NO NOT LIKE 'POL-%'",
          "severity": "low",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_COMPLETENESS_004",
          "name": "occupation_code_null_check",
          "description": "Check if occupation code is populated",
          "natural_language": "Occupation code should be populated.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE CUS_OCCUP_CD IS NULL",
          "severity": "low",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_ACCURACY_005",
          "name": "projected_retirement_age_reasonableness_check",
          "description": "Check if projected retirement age is within a reasonable range",
          "natural_language": "Projected retirement age should be within a reasonable range (e.g., 55-75).",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE SCM_PROJ_RET_AGE < 55 OR SCM_PROJ_RET_AGE > 75",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_CONFORMITY_004",
          "name": "smoker_status_valid_check",
          "description": "Check if smoker status is a valid value (e.g., Y, N)",
          "natural_language": "Smoker status must be a valid value (e.g., Y, N).",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE CUS_SMOKER_STAT NOT IN ('Y', 'N')",
          "severity": "medium",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_TEMPORAL_005",
          "name": "policy_renewal_date_consistency",
          "description": "Check if policy renewal date changes drastically between weeks",
          "natural_language": "Policy renewal date should not change drastically between weeks.",
          "sql": "SELECT w1.CUS_ID, w1.SCH_RENEWAL_DT AS week1_renewal_date, w2.SCH_RENEWAL_DT AS week2_renewal_date FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE ABS(DATE_DIFF(SAFE.PARSE_DATE('%Y-%m-%d', w1.SCH_RENEWAL_DT), SAFE.PARSE_DATE('%Y-%m-%d', w2.SCH_RENEWAL_DT), DAY)) > 30",
          "severity": "medium",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_UNIQUENESS_001",
          "name": "duplicate_customer_id_check",
          "description": "Check for duplicate customer IDs within the table",
          "natural_language": "Customer IDs should be unique within the table.",
          "sql": "SELECT CUS_ID, COUNT(*) FROM `PROJECT.DATASET.TABLE_NAME` GROUP BY CUS_ID HAVING COUNT(*) > 1",
          "severity": "high",
          "dq_dimension": "Uniqueness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        },
        {
          "rule_id": "DQ_ACCURACY_006",
          "name": "death_date_before_dob_check",
          "description": "Check if death date is before date of birth",
          "natural_language": "Death date cannot be before date of birth.",
          "sql": "SELECT * FROM `PROJECT.DATASET.TABLE_NAME` WHERE SAFE.PARSE_DATE('%Y-%m-%d', CUS_DEATH_DATE) < SAFE.PARSE_DATE('%Y-%m-%d', CUS_DOB)",
          "severity": "critical",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week1"
        }
      ],
      "generated_at": "2025-12-11T13:03:27.004237",
      "rule_count": 20
    },
    "policies_week2": {
      "rules": [
        {
          "rule_id": "DQ_COMPLETENESS_001",
          "name": "death_date_completeness_check",
          "description": "Check if CUS_DEATH_DATE is populated when CUS_LIFE_STATUS is 'DCD'",
          "natural_language": "If a customer's life status is deceased, then their death date should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_LIFE_STATUS = 'DCD' AND CUS_DEATH_DATE IS NULL",
          "severity": "critical",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "dataplex",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_COMPLETENESS_002",
          "name": "scheme_leave_date_completeness_check",
          "description": "Check if SCM_SCH_LEAVE_DATE is populated when SCM_MEMBER_STATUS is not 'Active'",
          "natural_language": "If a scheme member is not active, then their scheme leave date should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SCM_MEMBER_STATUS != 'Active' AND SCM_SCH_LEAVE_DATE IS NULL",
          "severity": "medium",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "dataplex",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_001",
          "name": "future_projected_retirement_date_check",
          "description": "Check if SCM_PROJ_RET_DT is not in the future",
          "natural_language": "The projected retirement date should not be a future date.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SCM_PROJ_RET_DT > CURRENT_DATE()",
          "severity": "high",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_002",
          "name": "negative_gross_premium_check",
          "description": "Check if POLI_GROSS_PMT is not negative",
          "natural_language": "The gross premium payment should not be a negative value.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLI_GROSS_PMT < 0",
          "severity": "critical",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_CONFORMITY_001",
          "name": "ni_number_format_check",
          "description": "Check if CUS_NI_NO matches the UK National Insurance number format",
          "natural_language": "The National Insurance number should match the standard UK format.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_NI_NO IS NOT NULL AND NOT REGEXP_CONTAINS(CUS_NI_NO, r'^[A-Z]{2}[0-9]{6}[A-D]$')",
          "severity": "medium",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_TIMELINESS_001",
          "name": "deceased_status_reversal_check",
          "description": "Check if a customer marked as deceased in an earlier week becomes alive in a later week",
          "natural_language": "Customers who were deceased should not become alive in later weeks - this indicates a data quality issue",
          "sql": "SELECT w1.CUS_ID, w1.CUS_LIFE_STATUS as week1_status, w2.CUS_LIFE_STATUS as week2_status FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_LIFE_STATUS = 'DCD' AND w2.CUS_LIFE_STATUS != 'DCD'",
          "severity": "critical",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_TIMELINESS_002",
          "name": "dob_change_across_weeks",
          "description": "Check if a customer's date of birth changes between weeks",
          "natural_language": "A customer's date of birth should not change from one week to the next.",
          "sql": "SELECT w1.CUS_ID FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_DOB != w2.CUS_DOB",
          "severity": "high",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_TIMELINESS_003",
          "name": "premium_fluctuation_check",
          "description": "Check for significant fluctuations in POLI_GROSS_PMT across weeks",
          "natural_language": "The gross premium payment should not fluctuate significantly from one week to the next.",
          "sql": "SELECT w1.CRL_KEY_POLICY_NO FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CRL_KEY_POLICY_NO = w2.CRL_KEY_POLICY_NO WHERE ABS(w1.POLI_GROSS_PMT - w2.POLI_GROSS_PMT) > (0.2 * w1.POLI_GROSS_PMT)",
          "severity": "medium",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_003",
          "name": "date_of_birth_future_check",
          "description": "Check if CUS_DOB is not in the future",
          "natural_language": "The customer's date of birth should not be a future date.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SAFE.PARSE_DATE('%Y-%m-%d', CUS_DOB) > CURRENT_DATE()",
          "severity": "critical",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_CONFORMITY_002",
          "name": "postcode_format_check",
          "description": "Check if CUS_POSTCODE matches the UK postcode format",
          "natural_language": "The customer's postcode should match the standard UK format.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_POSTCODE IS NOT NULL AND NOT REGEXP_CONTAINS(CUS_POSTCODE, r'^[A-Z]{1,2}[0-9][A-Z0-9]? [0-9][A-Z]{2}$')",
          "severity": "low",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_COMPLETENESS_003",
          "name": "customer_id_not_null",
          "description": "Check if CUS_ID is not null",
          "natural_language": "Customer ID should not be null",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_ID IS NULL",
          "severity": "critical",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_004",
          "name": "income_payment_reasonableness",
          "description": "Check if POLI_INCOME_PMT is within a reasonable range",
          "natural_language": "The income payment should be within a reasonable range.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLI_INCOME_PMT < 0 OR POLI_INCOME_PMT > 100000",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_TIMELINESS_004",
          "name": "renewal_date_consistency",
          "description": "Check if SCH_RENEWAL_DT is consistent across weeks for the same policy",
          "natural_language": "The scheme renewal date should be consistent across different weeks for the same policy.",
          "sql": "SELECT w1.CRL_KEY_POLICY_NO FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CRL_KEY_POLICY_NO = w2.CRL_KEY_POLICY_NO WHERE w1.SCH_RENEWAL_DT != w2.SCH_RENEWAL_DT",
          "severity": "medium",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_005",
          "name": "projected_retirement_age_reasonableness",
          "description": "Check if SCM_PROJ_RET_AGE is within a reasonable range (e.g., 50-75)",
          "natural_language": "The projected retirement age should be within a reasonable range.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SCM_PROJ_RET_AGE < 50 OR SCM_PROJ_RET_AGE > 75",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_COMPLETENESS_004",
          "name": "smoker_status_completeness",
          "description": "Check if CUS_SMOKER_STAT is populated",
          "natural_language": "Customer smoker status should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_SMOKER_STAT IS NULL",
          "severity": "low",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_006",
          "name": "tax_payment_reasonableness",
          "description": "Check if POLI_TAX_PMT is within a reasonable percentage of POLI_GROSS_PMT",
          "natural_language": "The tax payment should be within a reasonable percentage of the gross premium payment.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLI_TAX_PMT > POLI_GROSS_PMT",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_TIMELINESS_005",
          "name": "death_date_consistency",
          "description": "Check if CUS_DEATH_DATE is consistent across weeks for the same customer",
          "natural_language": "The customer's death date should be consistent across different weeks.",
          "sql": "SELECT w1.CUS_ID FROM `PROJECT.DATASET.policies_week1` w1 JOIN `PROJECT.DATASET.policies_week2` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_DEATH_DATE != w2.CUS_DEATH_DATE AND w1.CUS_DEATH_DATE IS NOT NULL AND w2.CUS_DEATH_DATE IS NOT NULL",
          "severity": "high",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_007",
          "name": "payment_day_validity",
          "description": "Check if POLID_PAYMENT_DAY is a valid day of the month (1-31)",
          "natural_language": "The payment day should be a valid day of the month.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLID_PAYMENT_DAY < 1 OR POLID_PAYMENT_DAY > 31",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_COMPLETENESS_005",
          "name": "policy_income_type_completeness",
          "description": "Check if POLID_INCOME_TYPE is populated",
          "natural_language": "Policy income type should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLID_INCOME_TYPE IS NULL",
          "severity": "low",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        },
        {
          "rule_id": "DQ_ACCURACY_008",
          "name": "unit_transaction_amount_reasonableness",
          "description": "Check if UNT_TRAN_AMT is within a reasonable range",
          "natural_language": "The unit transaction amount should be within a reasonable range.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE UNT_TRAN_AMT < -10000 OR UNT_TRAN_AMT > 10000",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week2"
        }
      ],
      "generated_at": "2025-12-12T14:54:31.660192",
      "rule_count": 20
    },
    "policies_week3": {
      "rules": [
        {
          "rule_id": "DQ_COMPLETENESS_001",
          "name": "death_date_completeness_check",
          "description": "Check if CUS_DEATH_DATE is populated when CUS_LIFE_STATUS is 'DCD'",
          "natural_language": "If a customer's life status is deceased, then their death date should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_LIFE_STATUS = 'DCD' AND CUS_DEATH_DATE IS NULL",
          "severity": "critical",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "dataplex",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_COMPLETENESS_002",
          "name": "scheme_leave_date_completeness_check",
          "description": "Check if SCM_SCH_LEAVE_DATE is populated when SCM_MEMBER_STATUS is not 'Active'",
          "natural_language": "If a scheme member is not active, then their scheme leave date should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SCM_MEMBER_STATUS != 'Active' AND SCM_SCH_LEAVE_DATE IS NULL",
          "severity": "medium",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "dataplex",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_001",
          "name": "future_projected_retirement_date_check",
          "description": "Check if SCM_PROJ_RET_DT is not in the future",
          "natural_language": "The projected retirement date should not be a future date.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SCM_PROJ_RET_DT > CURRENT_DATE()",
          "severity": "high",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_002",
          "name": "negative_gross_premium_check",
          "description": "Check if POLI_GROSS_PMT is not negative",
          "natural_language": "The gross premium payment should not be a negative value.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLI_GROSS_PMT < 0",
          "severity": "critical",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_CONFORMITY_001",
          "name": "ni_number_format_check",
          "description": "Check if CUS_NI_NO matches the UK National Insurance number format",
          "natural_language": "The National Insurance number should match the standard UK format.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_NI_NO IS NOT NULL AND NOT REGEXP_CONTAINS(CUS_NI_NO, r'^[A-Z]{2}[0-9]{6}[A-D]$')",
          "severity": "medium",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_TIMELINESS_001",
          "name": "deceased_status_reversal_check",
          "description": "Check if a customer marked as deceased in an earlier week becomes alive in a later week",
          "natural_language": "Customers who were deceased should not become alive in later weeks - this indicates a data quality issue",
          "sql": "SELECT w2.CUS_ID, w1.CUS_LIFE_STATUS as week1_status, w2.CUS_LIFE_STATUS as week2_status FROM `PROJECT.DATASET.policies_week2` w1 JOIN `PROJECT.DATASET.policies_week3` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_LIFE_STATUS = 'DCD' AND w2.CUS_LIFE_STATUS != 'DCD'",
          "severity": "critical",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_TIMELINESS_002",
          "name": "dob_change_across_weeks",
          "description": "Check if a customer's date of birth changes between weeks",
          "natural_language": "A customer's date of birth should not change from one week to the next.",
          "sql": "SELECT w2.CUS_ID FROM `PROJECT.DATASET.policies_week2` w1 JOIN `PROJECT.DATASET.policies_week3` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_DOB != w2.CUS_DOB",
          "severity": "high",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_TIMELINESS_003",
          "name": "premium_fluctuation_check",
          "description": "Check for significant fluctuations in POLI_GROSS_PMT across weeks",
          "natural_language": "The gross premium payment should not fluctuate significantly from one week to the next.",
          "sql": "SELECT w2.CRL_KEY_POLICY_NO FROM `PROJECT.DATASET.policies_week2` w1 JOIN `PROJECT.DATASET.policies_week3` w2 ON w1.CRL_KEY_POLICY_NO = w2.CRL_KEY_POLICY_NO WHERE ABS(w1.POLI_GROSS_PMT - w2.POLI_GROSS_PMT) > (0.2 * w1.POLI_GROSS_PMT)",
          "severity": "medium",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_003",
          "name": "date_of_birth_future_check",
          "description": "Check if CUS_DOB is not in the future",
          "natural_language": "The customer's date of birth should not be a future date.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SAFE.PARSE_DATE('%Y-%m-%d', CUS_DOB) > CURRENT_DATE()",
          "severity": "critical",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_CONFORMITY_002",
          "name": "postcode_format_check",
          "description": "Check if CUS_POSTCODE matches the UK postcode format",
          "natural_language": "The customer's postcode should match the standard UK format.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_POSTCODE IS NOT NULL AND NOT REGEXP_CONTAINS(CUS_POSTCODE, r'^[A-Z]{1,2}[0-9][A-Z0-9]? [0-9][A-Z]{2}$')",
          "severity": "low",
          "dq_dimension": "Conformity",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_COMPLETENESS_003",
          "name": "customer_id_not_null",
          "description": "Check if CUS_ID is not null",
          "natural_language": "Customer ID should not be null",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_ID IS NULL",
          "severity": "critical",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_004",
          "name": "income_payment_reasonableness",
          "description": "Check if POLI_INCOME_PMT is within a reasonable range",
          "natural_language": "The income payment should be within a reasonable range.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLI_INCOME_PMT < 0 OR POLI_INCOME_PMT > 100000",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_TIMELINESS_004",
          "name": "renewal_date_consistency",
          "description": "Check if SCH_RENEWAL_DT is consistent across weeks for the same policy",
          "natural_language": "The scheme renewal date should be consistent across different weeks for the same policy.",
          "sql": "SELECT w2.CRL_KEY_POLICY_NO FROM `PROJECT.DATASET.policies_week2` w1 JOIN `PROJECT.DATASET.policies_week3` w2 ON w1.CRL_KEY_POLICY_NO = w2.CRL_KEY_POLICY_NO WHERE w1.SCH_RENEWAL_DT != w2.SCH_RENEWAL_DT",
          "severity": "medium",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_005",
          "name": "projected_retirement_age_reasonableness",
          "description": "Check if SCM_PROJ_RET_AGE is within a reasonable range (e.g., 50-75)",
          "natural_language": "The projected retirement age should be within a reasonable range.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE SCM_PROJ_RET_AGE < 50 OR SCM_PROJ_RET_AGE > 75",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_COMPLETENESS_004",
          "name": "smoker_status_completeness",
          "description": "Check if CUS_SMOKER_STAT is populated",
          "natural_language": "Customer smoker status should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE CUS_SMOKER_STAT IS NULL",
          "severity": "low",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_006",
          "name": "tax_payment_reasonableness",
          "description": "Check if POLI_TAX_PMT is within a reasonable percentage of POLI_GROSS_PMT",
          "natural_language": "The tax payment should be within a reasonable percentage of the gross premium payment.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLI_TAX_PMT > POLI_GROSS_PMT",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_TIMELINESS_005",
          "name": "death_date_consistency",
          "description": "Check if CUS_DEATH_DATE is consistent across weeks for the same customer",
          "natural_language": "The customer's death date should be consistent across different weeks.",
          "sql": "SELECT w2.CUS_ID FROM `PROJECT.DATASET.policies_week2` w1 JOIN `PROJECT.DATASET.policies_week3` w2 ON w1.CUS_ID = w2.CUS_ID WHERE w1.CUS_DEATH_DATE != w2.CUS_DEATH_DATE AND w1.CUS_DEATH_DATE IS NOT NULL AND w2.CUS_DEATH_DATE IS NOT NULL",
          "severity": "high",
          "dq_dimension": "Timeliness",
          "scope": "cross_week",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_007",
          "name": "payment_day_validity",
          "description": "Check if POLID_PAYMENT_DAY is a valid day of the month (1-31)",
          "natural_language": "The payment day should be a valid day of the month.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLID_PAYMENT_DAY < 1 OR POLID_PAYMENT_DAY > 31",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_COMPLETENESS_005",
          "name": "policy_income_type_completeness",
          "description": "Check if POLID_INCOME_TYPE is populated",
          "natural_language": "Policy income type should be populated.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE POLID_INCOME_TYPE IS NULL",
          "severity": "low",
          "dq_dimension": "Completeness",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        },
        {
          "rule_id": "DQ_ACCURACY_008",
          "name": "unit_transaction_amount_reasonableness",
          "description": "Check if UNT_TRAN_AMT is within a reasonable range",
          "natural_language": "The unit transaction amount should be within a reasonable range.",
          "sql": "SELECT * FROM `{TABLE_NAME}` WHERE UNT_TRAN_AMT < -10000 OR UNT_TRAN_AMT > 10000",
          "severity": "medium",
          "dq_dimension": "Accuracy",
          "scope": "single_table",
          "source": "agent",
          "table": "policies_week3"
        }
      ],
      "generated_at": "2025-12-12T14:54:31.665194",
      "rule_count": 20
    }
  }
}